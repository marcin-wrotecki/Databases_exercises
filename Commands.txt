--1--
-- pobrałem pliki, skopiowałem zgodnie z readmie.txt
--https://postgis.net/install/
--2--
CREATE DATABASE Exercise_3

--3--
CREATE EXTENSION postGIS;

--4--
CREATE TABLE budynki(id INT PRIMARY KEY, geometria GEOMETRY, nazwa TEXT);
CREATE TABLE drogi(id INT PRIMARY KEY,  geometria GEOMETRY, nazwa TEXT);
CREATE TABLE punkty_informacyjne(id INT PRIMARY KEY, geometria GEOMETRY, nazwa TEXT);

--5--
INSERT INTO budynki VALUES (1, ST_GeomFromText('polygon((8 4,10.5 4,10.5 1.5,8 1.5,8 4))'), 'BuildingA');
INSERT INTO budynki VALUES (2, ST_GeomFromText('polygon((4 7,6 7,6 5,4 5,4 7))'), 'BuildingB');
INSERT INTO budynki VALUES (3, ST_GeomFromText('polygon((3 8,5 8,5 6,3 6,3 8))'), 'BuildingC');

INSERT INTO drogi VALUES (1, ST_GeomFromText('linestring(0 4.5, 12 4.5)'), 'RoadX');
INSERT INTO drogi VALUES (2, ST_GeomFromText('linestring(7.5 10.5, 7.5 0)'), 'RoadY');

INSERT INTO punkty_informacyjne VALUES (1, ST_GeomFromText('point(1 3.5)'), 'G');
INSERT INTO punkty_informacyjne VALUES (2, ST_GeomFromText('point(5.5 1.5)'), 'H');
INSERT INTO punkty_informacyjne VALUES (3, ST_GeomFromText('point(9.5 6)'), 'I');
INSERT INTO punkty_informacyjne VALUES (4, ST_GeomFromText('point(6.5 6)'), 'J');
INSERT INTO punkty_informacyjne VALUES (5, ST_GeomFromText('point(6 9.5)'), 'K');

--6--
--a--
SELECT SUM(ST_LENGTH(geometria)) FROM drogi;
--b--
SELECT ST_ASEWKT(geometria), ST_AREA(geometria) as pole, ST_PERIMETER (geometria) AS obwod FROM budynki WHERE nazwa = 'BuildingA';
--c--
SELECT nazwa, ST_AREA(geometria) AS pole FROM budynki ORDER BY nazwa;
--d--
SELECT nazwa, ST_PERIMETER(geometria) FROM budynki ORDER BY ST_AREA(geometria) DESC LIMIT 2;
--e--
SELECT ST_DISTANCE(budynki.geometria,punkty_informacyjne.geometria) FROM budynki JOIN punkty_informacyjne ON punkty_informacyjne.nazwa = 'G' AND budynki.nazwa='BuildingC';
--f-- 

--g--
SELECT budynki.nazwa FROM budynki WHERE ST_CENTROID(budynki.geometria)>(SELECT st_centroid(d.geometria) FROM drogi AS d WHERE d.nazwa='RoadX');
--h--
SELECT ST_AREA(ST_DIFFERENCE(geometria, ST_GEOMFROMTEXT('polygon((4 7, 6 7, 6 8, 4 8, 4 7))'))) FROM budynki  WHERE id=3;



